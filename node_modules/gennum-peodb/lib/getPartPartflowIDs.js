//============================================================================//

var print = console.log;

//============================================================================//

module.exports = function(PEODB) {

  var requiredArgs = [
    'part_id',
  ];

  PEODB.prototype.getPartPartflowIDs = function(args, cb) {
    var peodb = this;

    if (!(args instanceof Object)) {
      args = { part_id: args };
    }

    var missingArg = peodb.checkArgs(requiredArgs, args);
    if (missingArg) {
      return cb(Error('missing required argument: ' + missingArg));
    }

    var db = peodb.sharedDB;
    var part_id = args.part_id;

    getPartPartflowIDs(db, part_id, function(err, partflow_ids) {
      return cb(err, partflow_ids);
    });
  }

  function getPartPartflowIDs(db, part_id, cb) {
    var qStr =
      'SELECT distinct partflow_id FROM partflow_parts'
      + ' WHERE part_id = ' + db.escape(part_id);
    db.queryData(qStr, function(err, data) {
      if (err) {
        return cb(err);
      }
      return cb(null, data.toArray());
    });
  }
}

//============================================================================//
