//============================================================================//

var print = console.log;

//============================================================================//

module.exports = function(PEODB) {

  var qStr =
    'SELECT'
  + '      c.company_id'
  + '    , c.name'
  + '    , c.state'
  + '    , COUNT(cn.company_id) AS contacts_count'
  + '    , COUNT(li.company_id) AS liaisons_count'
  + '  FROM'
  + '    test_houses                th'
  + '    JOIN companies             c  ON ( c.company_id = th.company_id)'
  + '    LEFT JOIN contacts         cn ON (cn.company_id = th.company_id)'
  + '    LEFT JOIN company_liaisons li ON (li.company_id = th.company_id)'
  + '  GROUP BY th.company_id'
  ;

  PEODB.prototype.getTestHouses = function(args, cb) {
    var peodb = this;

    if (typeof(args) === 'function') {
      cb = args;
    }

    peodb.sharedDB.queryData(qStr, cb);
  }
}

//============================================================================//
