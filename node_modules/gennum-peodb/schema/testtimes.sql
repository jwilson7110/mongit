################################################################################

CREATE TABLE `test_times` (
  `test_time_id`        INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY
, `blob_id`             INT UNSIGNED -- Test times can be pulled
, `datalog_id`          INT UNSIGNED -- from blobs (uploads), or datalogs
, `test_suite`          VARCHAR(255) NOT NULL
, `part_count`          INT UNSIGNED NOT NULL
, `duration`            FLOAT        NOT NULL
, FOREIGN KEY (`blob_id`)    REFERENCES `blobs`    (`blob_id`)
, FOREIGN KEY (`datalog_id`) REFERENCES `datalogs` (`datalog_id`)
);

INSERT INTO dbdoc(`table_name`, `field_name`, `description`) VALUES
  ("test_times", NULL,           "test suite test times")
, ("test_times", "test_time_id", "primary key")
, ("test_times", "blob_id",      "foreign key into blobs")
, ("test_times", "datalog_id",   "foreign key into datalogs")
, ("test_times", "test_suite",   "test suite name")
, ("test_times", "part_count",   "the number of parts tested")
, ("test_times", "duration",     "average test time (in seconds)")
;

CREATE TABLE `test_time_entries` (
  `test_time_entry_id`  INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY
, `test_time_id`        INT UNSIGNED NOT NULL
, `time_type`           ENUM('TOTAL','SETUP','EXECUTE') NOT NULL
, `time_calc`           ENUM('SUM','MIN','MAX','AVG')   NOT NULL
, `duration`            FLOAT        NOT NULL
, UNIQUE  KEY (`test_time_id`, `time_type`, `time_calc`)
, FOREIGN KEY (`test_time_id`) REFERENCES `test_times` (`test_time_id`)
);

################################################################################
